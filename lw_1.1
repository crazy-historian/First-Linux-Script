#!/bin/bash

# вторая версия скрипта

# $1 - ключ, обозначающий приоритет
# $2 - исходная директория
# $3 - директория назначения

# проверка переданных аргументов
if [ ! -d $2 ] 
	then
	# создание исходной директории
	# (!) полное копирование в случае пустой директории (!)
	mkdir $2
elif [ ! -d $3 ]
	then
	# создание директории назначения
	mkdir $3
fi 

flag=0
case "$1" in
-r) # приоритет директории назначения
	flag=1 ;;
--) shift
break ;;
esac
shift


# цикл по исходной директории
for file in $1/*
do
	echo $(basename $file)

	# если файла нет в директории назначения
	flash_file=$($2/$(basename $file) )

	if [ ! -f $flash_file ]; then 
		echo "Файла нет в директория копирование..."
		cp $file $2

	# файл есть в директории назначения и он редактирован позже, чем в исходной
	elif [ -f $flash_file ] && [ $(ls -l $file) lt $(ls -l $flash_file) ]; then
		cp $file $2
		echo "Обновление файла..."

	# файл есть в директории назначения и он отредактирован раньше, чем в исходной
	elif [ $(ls -l $file) qt $(ls -l $flash_file) ] && [ $flag -eq 0]; then
		cp $file $2	fi                                                                                                                                     
done




                                                     
